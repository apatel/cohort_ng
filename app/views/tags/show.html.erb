<h1>Tag: "<%= @tag.hierarchical_name %>"</h1>

<div class="grid_5 alpha">
  <div class="tabs">
    <ul>
      <li><%= link_to('Contacts', url_for(:controller => :contact_query, :action => :tag_contacts, :id => @tag.id)) %></li>
      <li><a href="#tools">Tools</a></li>
    </ul>
    <div id="tools">
      <ul>
        <li><%= link_to(icon('group_add') + ' Add items from this tag to a list', '#', :class => "add_to_list", :data_object_type => 'ActsAsTaggableOn::Tag', :data_object_id => @tag.id, :title => @tag) %></li>
        <li><h3>Merge this tag into another tag</h3>
        <%= form_tag(merge_tag_path(@tag), :method => :post) do %>
          <%= label_tag(:new_tag_id, 'Select tag to merge into') %>:
          <%= select_tag(:new_tag_id, options_from_collection_for_select(ActsAsTaggableOn::Tag.all.sort_by{|t| t.hierarchical_name},'id','hierarchical_name')) %><br/>
          <%= label_tag(:delete, "Delete tag after merging") %> <%= check_box_tag(:delete, 1, true) %> <br/>
          <%= submit_tag('Merge') %>
        <% end %>
        </li>
      </ul>
    </div>
  </div>
</div>

<div class="grid_4 omega">
  <span class="tagMatches existingTags">
    <% unless @tag.ancestors.empty? %>
      <% @tag.ancestors.each do |t| %>
      <span><%= link_to(t, tag_path(t)) %></span>
      <div class="clear"></div>
    <% end %>
    <% end %>
    <h3>Includes items tagged with:</h3>
    <div style="margin-left: 1em">
      <% @tag.descendants.sort_by{|d| d.hierarchical_name}.each do|d| %>
        <span><%= link_to(d.hierarchical_name, tag_path(d)) %></span>
        <div class="clear"></div>
      <% end %>
    </div>
  </span>
</div>
